# Checklist Backend - Compartilha AI üìã

O objetivo deste checklist √© rastrear as funcionalidades implementadas no servidor (API).

---
## FASES ANTERIORES (Conclu√≠das)
- [x] **Prova de Conceito:** Valida√ß√£o da API do Gemini.
- [x] **Extra√ß√£o com IA:** Implementa√ß√£o do servi√ßo que l√™ a imagem da comanda.
- [x] **API Inicial:** Cria√ß√£o dos endpoints de scan e de cria√ß√£o de divis√£o.
- [x] **L√≥gica de Divis√£o:** Implementa√ß√£o da distribui√ß√£o de itens e c√°lculo inicial de totais.

---
## FASE ATUAL: Flexibilidade e Edi√ß√£o da Conta (Conclu√≠da)

**üéØ Objetivo:** Tornar a API robusta, permitindo que o usu√°rio edite a conta ap√≥s o scan da IA e tenha controle sobre taxas e descontos.

### 1. Atualiza√ß√£o dos Modelos de Dados (`schemas.py`)
- [x] Adicionar campo `desconto_valor` ao schema `Divisao`.
- [x] Criar schema `ConfigDivisao` para receber atualiza√ß√µes de taxa e desconto.
- [x] Criar schema `ItemPayload` para receber dados de novos itens ou de edi√ß√µes.
- [x] Criar schema `AddPessoaRequest` para adicionar novas pessoas.

### 2. Implementa√ß√£o dos Endpoints de Edi√ß√£o (`main.py`)
- [x] Criar endpoint `PUT /api/divisao/{divisao_id}/config` para atualizar taxa e desconto.
- [x] Criar endpoint `POST /api/divisao/{divisao_id}/item` para adicionar um novo item √† divis√£o.
- [x] Criar endpoint `PUT /api/divisao/{divisao_id}/item/{item_id}` para editar um item existente.
- [x] Criar endpoint `DELETE /api/divisao/{divisao_id}/item/{item_id}` para remover um item.
- [x] Criar endpoint `POST /api/divisao/{divisao_id}/pessoa` para adicionar uma nova pessoa.

### 3. L√≥gica de C√°lculo Avan√ßada (`main.py`)
- [x] Refatorar o endpoint `GET /api/calcular-totais/{divisao_id}`.
- [x] Implementar a l√≥gica de desconto proporcional.
- [x] Garantir que a ordem dos c√°lculos seja: (Subtotal dos Itens - Desconto) + Taxa de Servi√ßo.
- [x] Distribuir todos os custos e benef√≠cios (taxa, desconto) de forma proporcional ao consumo de cada pessoa.

---
## DEPLOY (Conclu√≠do)
- [x] **Configurar CORS:** Permitir acesso do frontend (Vercel).
- [x] **Criar `requirements.txt`:** Listar todas as depend√™ncias do projeto.
- [x] **Criar `Procfile`:** Definir o comando para o Render iniciar o servidor.
- [x] **Publicar no Render:** Fazer o deploy da API para a nuvem.

---
## FASE ATUAL: Novas Features de Usabilidade

- [x] **Adicionar Pessoa Dinamicamente:** Endpoint (`POST /api/divisao/{divisao_id}/pessoa`) j√° existia e foi validado.

---
## PR√ìXIMAS FASES (Futuro)
- [x] **Distribui√ß√£o por Valor:** Adaptar a l√≥gica de distribui√ß√£o para aceitar divis√µes fracionadas de um item.
- [ ] **Persist√™ncia de Dados:** Salvar as divis√µes em um banco de dados para que n√£o se percam.
- [ ] **Autentica√ß√£o:** Adicionar um sistema de login se o app se tornar multi-usu√°rio.
